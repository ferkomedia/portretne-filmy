---
import BaseLayout from "../layouts/BaseLayout.astro";
import terms from "../data/workshop-terms.json";
---

<BaseLayout title="Admin | Správa workshopov" noindex={true}>
  <section class="hero">
    <div class="eyebrow">Admin</div>
    <h1>Správa termínov workshopov</h1>
    <p class="lead">Pridávaj, upravuj a spravuj termíny workshopov.</p>
  </section>

  <section class="section">
    <h2>Aktuálne termíny</h2>

    {terms.length === 0 ? (
      <div class="card">
        <p>Žiadne termíny. Pridaj prvý termín nižšie.</p>
      </div>
    ) : (
      <div class="adminTable">
        <table>
          <thead>
            <tr>
              <th>Workshop</th>
              <th>Dátum</th>
              <th>Mesto</th>
              <th>Cena</th>
              <th>Kapacita</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {terms.map((t, i) => (
              <tr class={t.status === 'open' ? 'rowOpen' : 'rowClosed'}>
                <td>{t.title}</td>
                <td>{t.date}</td>
                <td>{t.city}</td>
                <td>{t.price} €</td>
                <td>{t.capacity}</td>
                <td>
                  <span class={`badge badge--${t.status === 'open' ? 'success' : 'muted'}`}>
                    {t.status === 'open' ? 'Otvorený' : 'Zatvorený'}
                  </span>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    )}
  </section>

  <section class="section">
    <h2>Pridať nový termín</h2>
    <div class="card">
      <form id="addTermForm">
        <div class="formGrid">
          <div class="field">
            <label for="title">Typ workshopu</label>
            <select id="title" required>
              <option value="">Vyber typ</option>
              <option value="Web za 1 deň">Web za 1 deň</option>
              <option value="E-shop za 1 deň">E-shop za 1 deň</option>
              <option value="Google reklama za 1 deň">Google reklama za 1 deň</option>
              <option value="Sociálne siete za 1 deň">Sociálne siete za 1 deň</option>
              <option value="AI nástroje za 1 deň">AI nástroje za 1 deň</option>
            </select>
          </div>

          <div class="field">
            <label for="date">Dátum</label>
            <input id="date" type="text" placeholder="DD.MM.RRRR" required pattern="\d{2}\.\d{2}\.\d{4}" />
          </div>

          <div class="field">
            <label for="city">Mesto</label>
            <input id="city" type="text" value="Martin" required />
          </div>

          <div class="field">
            <label for="price">Cena (€)</label>
            <input id="price" type="number" value="149" required />
          </div>

          <div class="field">
            <label for="capacity">Kapacita</label>
            <input id="capacity" type="number" value="12" required />
          </div>

          <div class="field">
            <label for="status">Status</label>
            <select id="status">
              <option value="open">Otvorený</option>
              <option value="closed">Zatvorený</option>
            </select>
          </div>
        </div>

        <div class="formActions">
          <button type="submit" class="btn btn--primary">Generovať JSON</button>
        </div>
      </form>

      <div id="jsonOutput" style="display:none; margin-top: 1.5rem;">
        <h3>Nový JSON záznam:</h3>
        <pre id="jsonCode" style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;"></pre>
        <p class="help">Skopíruj tento záznam a pridaj ho do súboru <code>src/data/workshop-terms.json</code></p>
      </div>
    </div>
  </section>

  <section class="section">
    <h2>Ako upraviť termíny</h2>
    <div class="grid2">
      <div class="card">
        <h3>1. Otvor súbor</h3>
        <p><code>src/data/workshop-terms.json</code></p>
      </div>
      <div class="card">
        <h3>2. Uprav JSON</h3>
        <p>Pridaj, zmeň alebo odstráň termíny.</p>
      </div>
      <div class="card">
        <h3>3. Commit & Push</h3>
        <p><code>git add . && git commit -m "Update terms" && git push</code></p>
      </div>
      <div class="card">
        <h3>4. Hotovo</h3>
        <p>Cloudflare automaticky deployuje zmeny.</p>
      </div>
    </div>
  </section>

  <section class="section">
    <h2>Príklad JSON štruktúry</h2>
    <div class="card">
      <pre style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; overflow-x: auto;">[
  {
    "title": "Web za 1 deň",
    "date": "25.01.2026",
    "city": "Martin",
    "price": 149,
    "capacity": 12,
    "status": "open"
  },
  {
    "title": "E-shop za 1 deň",
    "date": "08.02.2026",
    "city": "Martin",
    "price": 179,
    "capacity": 10,
    "status": "open"
  }
]</pre>
    </div>
  </section>

  <script>
    document.getElementById('addTermForm').addEventListener('submit', (e) => {
      e.preventDefault();

      const term = {
        title: document.getElementById('title').value,
        date: document.getElementById('date').value,
        city: document.getElementById('city').value,
        price: parseInt(document.getElementById('price').value),
        capacity: parseInt(document.getElementById('capacity').value),
        status: document.getElementById('status').value
      };

      const json = JSON.stringify(term, null, 2);
      document.getElementById('jsonCode').textContent = json;
      document.getElementById('jsonOutput').style.display = 'block';
    });
  </script>
</BaseLayout>

<style>
  .adminTable {
    overflow-x: auto;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  th, td {
    padding: 0.75rem 1rem;
    text-align: left;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  th {
    background: rgba(255,255,255,0.05);
    font-weight: 600;
  }
  .rowOpen {
    background: rgba(34, 197, 94, 0.1);
  }
  .rowClosed {
    opacity: 0.6;
  }
  .badge {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
  }
  .badge--success {
    background: #22c55e;
    color: white;
  }
  .badge--muted {
    background: rgba(255,255,255,0.2);
    color: rgba(255,255,255,0.7);
  }
  code {
    background: rgba(255,255,255,0.1);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    font-family: monospace;
  }
  pre {
    font-family: monospace;
    font-size: 0.875rem;
    line-height: 1.5;
  }
</style>
